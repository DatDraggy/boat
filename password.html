<?php
require_once('backend/config.php');
require_once('backend/funcs.php');
require_once('backend/includes.php');
if (!empty($_GET['token'])) {
  $token = $_GET['token'];
  $dbConnection = buildDatabaseConnection($config);
  $userId = getIdFromToken($token);
  if ($userId !== false) {
  } else {
    header('Location: login');
    die();
  }
} else {
  header('Location: login');
  die();
}
?>
<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <title>Hot Summer Nights: Furry Summerbo.at Party</title>
  <?php echo $head; ?>
</head>
<body class="hasNav">
<div id="app">
  <nav id="nav" class="nav inactive">
    <div class="wrapper">
      <div class="navContent">
        <button class="navItem js-showNav">
          <i class="la la-bars"></i><span>Menu</span>
        </button>

        <div class="navLinks">
          <div class="navItem navItemLogo">
            <a class="navLink" href="/"><img alt="Summerbo.at Logo" src="images/logo@2x.png" width="48">
              <p style="margin-left: 1rem;" class="heading5 subheadline nomargin">Hot Summer Nights</p></a>
          </div>
          <div class="navItem">
            <a class="navLink" href="/index.html#about">About</a>
          </div>
          <div class="navItem">
            <a class="navLink" href="/index.html#tickets">Tickets</a>
          </div>
          <div class="navItem">
            <a class="navLink" href="/index.html#faq">FAQ</a>
          </div>
          <div class="navItem">
            <a class="navLink" href="/index.html#team">Team</a>
          </div>
          <div class="navItem">
            <a class="navLink" href="https://berlincodeofconduct.org/" target="_blank">Conduct</a>
          </div>
        </div>
        <div class="navButtons">
          <div class="navItem">
            <a class="button navItemButton buttonPrimary" href="/register.html"><i style="font-size: 24px; margin-right: .5rem; margin-top:-4px;" class="la la-ticket"></i>Register</a>
          </div>
          <div class="navItem">
            <a class="button navItemButton buttonSecondary" href="/login.html"><i style="font-size: 24px; margin-right: .5rem; margin-top:-4px;" class="la la-key"></i>Login</a>
          </div>
        </div>
      </div>
    </div>
  </nav>

  <section id="contentPage" class="noHeader wrapper wrapperCentered">
    <section>
      <div class="row">
        <div class="content">
          <p><img alt="Summerbo.at Main Image Banner" style="margin: 0 auto" src="images/main@2x.png" width="320"></p>
        </div>
      </div>
    </section>
    <section id="registration-form">
      <div class="row">
        <div class="content">
          <h3>Login</h3>
          <form class="formWrapper" id="login" action="backend/change_password.php" method="post">
            <input type="text" value="<?php echo $token; ?>" hidden>
            <div class="inputWrapper">
              <label for="password"><span>New Password</span></label>
              <input name="password" type="password" id="password" class="input" placeholder="Enter your new password"
                     required/>
            </div>
            <div class="formRow">
              <div class="inputWrapper">
                <label for="passwordVerify"><span>Confirm new Password</span></label>
                <input name="passwordVerify" type="password" id="passwordVerify" class="input" placeholder="Confirm your new password"
                       required/>
              </div>
            </div>
            <div class="formRow">
              <button class="button buttonPrimary">Submit</button>
            </div>
          </form>
        </div>
      </div>
    </section>
  </section> <!--pageWrapper -->
  <?php echo $footer; ?>
</body>
</html>
